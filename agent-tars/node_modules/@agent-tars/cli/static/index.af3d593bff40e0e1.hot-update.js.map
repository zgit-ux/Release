{"version":3,"file":"index.af3d593bff40e0e1.hot-update.js","sources":["/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/entry.css","/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/standalone/chat/Message/components/ToolCalls.tsx"],"sourcesContent":["// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1751740621734\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.3.9_@swc+helpers@0.5.17/node_modules/@rspack/core/dist/cssExtractHmr.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","import React from 'react';\nimport { FiLoader, FiCheck, FiX, FiClock, FiAlertCircle } from 'react-icons/fi';\nimport { motion } from 'framer-motion';\nimport { ActionButton } from './ActionButton';\nimport { useAtomValue } from 'jotai';\nimport { streamingToolCallsAtom } from '@/common/state/atoms/streamingToolCall';\nimport { useSession } from '@/common/hooks/useSession';\n\ninterface ToolCallsProps {\n  toolCalls: any[];\n  onToolCallClick: (toolCall: any) => void;\n  getToolIcon: (name: string) => React.ReactNode;\n  isIntermediate?: boolean;\n  toolResults?: any[];\n}\n\n/**\n * Component for displaying tool calls with enhanced icons and loading states\n * Now supports showing streaming tool calls before completion\n */\nexport const ToolCalls: React.FC<ToolCallsProps> = ({\n  toolCalls,\n  onToolCallClick,\n  getToolIcon,\n  isIntermediate = false,\n  toolResults = [],\n}) => {\n  const { activeSessionId } = useSession();\n  const streamingToolCalls = useAtomValue(streamingToolCallsAtom);\n  \n  // Get streaming state for current session\n  const sessionStreamingCalls = activeSessionId ? streamingToolCalls[activeSessionId] || {} : {};\n\n  // Helper function to get tool call status\n  const getToolCallStatus = (toolCall: any) => {\n    // Check if this tool call is currently streaming\n    const streamingState = sessionStreamingCalls[toolCall.id];\n    if (streamingState) {\n      return 'streaming';\n    }\n    \n    const result = toolResults.find((result) => result.toolCallId === toolCall.id);\n\n    if (!result) {\n      return 'pending';\n    }\n\n    if (result.error) {\n      return 'error';\n    }\n\n    return 'success';\n  };\n\n  // Helper function to get status icon with enhanced visual styling\n  const getStatusIcon = (status: string, toolName: string) => {\n    switch (status) {\n      case 'streaming':\n        return (\n          <motion.div\n            animate={{ \n              scale: [1, 1.1, 1],\n              opacity: [0.7, 1, 0.7]\n            }}\n            transition={{ \n              duration: 1.5, \n              repeat: Infinity, \n              ease: 'easeInOut' \n            }}\n          >\n            <FiLoader size={16} className=\"text-blue-600 dark:text-blue-400\" />\n          </motion.div>\n        );\n      case 'pending':\n        return (\n          <motion.div\n            animate={{ rotate: 360 }}\n            transition={{ duration: 1, repeat: Infinity, ease: 'linear' }}\n          >\n            <FiLoader size={16} className=\"text-slate-500 dark:text-slate-400\" />\n          </motion.div>\n        );\n      case 'success':\n        return <FiCheck size={16} className=\"text-green-600 dark:text-green-400\" />;\n      case 'error':\n        return <FiAlertCircle size={16} className=\"text-red-600 dark:text-red-400\" />;\n      default:\n        return <FiClock size={16} className=\"text-slate-500 dark:text-slate-400\" />;\n    }\n  };\n\n  // 生成工具描述文本 - 增强描述信息的可读性\n  const getToolDescription = (toolCall: any) => {\n    try {\n      const args = JSON.parse(toolCall.function.arguments || '{}');\n\n      switch (toolCall.function.name) {\n        case 'web_search':\n          return args.query ? `\"${args.query}\"` : '';\n        case 'browser_navigate':\n          // 限制 URL 长度以避免溢出\n          return args.url;\n        case 'browser_vision_control':\n        case 'browser_control':\n          return args.action ? `${args.action}` : '';\n        case 'browser_click':\n          return args.selector || args.text ? `click: ${args.selector || args.text}` : 'click';\n        case 'list_directory':\n          return args.path ? `path: ${args.path}` : '';\n        case 'run_command':\n          return args.command;\n\n        case 'read_file':\n        case 'write_file':\n          return args.path ? `file: ${args.path.split('/').pop()}` : '';\n        default:\n          return '';\n      }\n    } catch (error) {\n      console.error('Failed to parse tool arguments:', error);\n      return '';\n    }\n  };\n\n  // 获取浏览器操作结果说明\n  const getResultInfo = (toolCall: any, status: string) => {\n    const result = toolResults.find((result) => result.toolCallId === toolCall.id);\n\n    if (status === 'error' && result?.error) {\n      return '\"operation failed\"';\n    } else if (status === 'success') {\n      if (toolCall.function.name === 'browser_get_markdown') {\n        return '\"content retrieved\"';\n      } else if (toolCall.function.name === 'browser_navigate') {\n        return '\"navigation success\"';\n      } else if (toolCall.function.name === 'browser_click') {\n        return '\"click successful\"';\n      } else if (toolCall.function.name.startsWith('run_')) {\n        return '\"command executed\"';\n      } else if (toolCall.function.name.startsWith('list_')) {\n        return '\"files listed\"';\n      } else if (toolCall.function.name.startsWith('read_')) {\n        return '\"file read\"';\n      } else if (toolCall.function.name.startsWith('write_')) {\n        return '\"file saved\"';\n      }\n    }\n\n    return '';\n  };\n\n  // 获取工具的格式化名称，使其更易读\n  const getToolDisplayName = (toolName: string) => {\n    // 替换下划线为空格\n    const nameWithSpaces = toolName.replace(/_/g, ' ');\n\n    // 特殊情况处理\n    switch (toolName) {\n      case 'browser_navigate':\n        return 'Navigate';\n      case 'browser_get_markdown':\n        return 'Extract Content';\n      case 'browser_click':\n        return 'Click Element';\n      case 'web_search':\n        return 'Web Search';\n      case 'list_directory':\n        return 'List Files';\n      case 'run_command':\n        return 'Run Command';\n      case 'read_file':\n        return 'Read File';\n      case 'write_file':\n        return 'Write File';\n      default:\n        // 首字母大写\n        return nameWithSpaces\n          .split(' ')\n          .map((word) => word.charAt(0).toUpperCase() + word.slice(1))\n          .join(' ');\n    }\n  };\n\n  return (\n    <div className=\"mt-2 space-y-1.5\">\n      {toolCalls.map((toolCall) => {\n        const status = getToolCallStatus(toolCall);\n        const description = getToolDescription(toolCall, status);\n        const browserInfo = getResultInfo(toolCall, status);\n        const displayName = getToolDisplayName(toolCall.function.name);\n\n        return (\n          <ActionButton\n            key={toolCall.id}\n            icon={getToolIcon(toolCall.function.name)}\n            label={displayName}\n            onClick={() => onToolCallClick(toolCall)}\n            status={status as 'pending' | 'success' | 'error'}\n            statusIcon={getStatusIcon(status, toolCall.function.name)}\n            description={description || browserInfo || undefined}\n          />\n        );\n      })}\n    </div>\n  );\n};"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AACA;AAUA;;;AAGA;AACA;;AAOA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AAAA;;;;;;;;;;;AAGA;AACA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;;;;;;;;;;;AAGA;AACA;AAAA;AAAA;;;;;;AACA;AACA;AAAA;AAAA;;;;;;AACA;AACA;AAAA;AAAA;;;;;;AACA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAIA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAGA;AACA;AACA;AACA;AACA;AACA;AANA;;;;;AASA;;;;;;AAGA;AAzLA;;AAOA;AACA;;;AARA"}