"use strict";
self["webpackHotUpdate_agent_tars_web_ui"]("index", {
"./src/entry.css": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
// extracted by css-extract-rspack-plugin

    if(true) {
      (function() {
        var localsJsonString = undefined;
        // 1751741382061
        var cssReload = (__webpack_require__("../node_modules/.pnpm/@rspack+core@1.3.9_@swc+helpers@0.5.17/node_modules/@rspack/core/dist/cssExtractHmr.js")/* .cssReload */.cssReload)(module.id, {});
        // only invalidate when locals change
        if (
          module.hot.data &&
          module.hot.data.value &&
          module.hot.data.value !== localsJsonString
        ) {
          module.hot.invalidate();
        } else {
          module.hot.accept();
        }
        module.hot.dispose(function(data) {
          data.value = localsJsonString;
          cssReload();
        });
      })();
    }
  

}),
"./src/common/hooks/useSession.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  useSession: () => (useSession)
});
/* ESM import */var jotai__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("../node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* ESM import */var _state_atoms_session__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("./src/common/state/atoms/session.ts");
/* ESM import */var _state_atoms_message__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("./src/common/state/atoms/message.ts");
/* ESM import */var _state_atoms_tool__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/common/state/atoms/tool.ts");
/* ESM import */var _state_atoms_plan__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/common/state/atoms/plan.ts");
/* ESM import */var _state_atoms_ui__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/common/state/atoms/ui.ts");
/* ESM import */var _state_atoms_replay__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/common/state/atoms/replay.ts");
/* ESM import */var _services_socketService__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/common/services/socketService.ts");
/* ESM import */var react__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("../node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* ESM import */var react__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_7__);
/* ESM import */var _hooks_useReplayMode__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/common/hooks/useReplayMode.tsx");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("../node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.3_react-refresh@0.16.0/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");










/**
 * Hook for session management functionality
 */ function useSession() {
    // State
    const [sessions, setSessions] = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useAtom)(_state_atoms_session__WEBPACK_IMPORTED_MODULE_0__.sessionsAtom);
    const [activeSessionId, setActiveSessionId] = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useAtom)(_state_atoms_session__WEBPACK_IMPORTED_MODULE_0__.activeSessionIdAtom);
    const messages = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useAtomValue)(_state_atoms_message__WEBPACK_IMPORTED_MODULE_1__.messagesAtom);
    const groupedMessages = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useAtomValue)(_state_atoms_message__WEBPACK_IMPORTED_MODULE_1__.groupedMessagesAtom);
    const toolResults = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useAtomValue)(_state_atoms_tool__WEBPACK_IMPORTED_MODULE_2__.toolResultsAtom);
    const streamingToolCalls = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useAtomValue)(_state_atoms_tool__WEBPACK_IMPORTED_MODULE_2__.streamingToolCallsAtom);
    const [isProcessing, setIsProcessing] = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useAtom)(_state_atoms_ui__WEBPACK_IMPORTED_MODULE_4__.isProcessingAtom);
    const [activePanelContent, setActivePanelContent] = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useAtom)(_state_atoms_ui__WEBPACK_IMPORTED_MODULE_4__.activePanelContentAtom);
    const [connectionStatus, setConnectionStatus] = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useAtom)(_state_atoms_ui__WEBPACK_IMPORTED_MODULE_4__.connectionStatusAtom);
    const [plans, setPlans] = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useAtom)(_state_atoms_plan__WEBPACK_IMPORTED_MODULE_3__.plansAtom);
    const setPlanUIState = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useSetAtom)(_state_atoms_plan__WEBPACK_IMPORTED_MODULE_3__.planUIStateAtom);
    const [replayState, setReplayState] = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useAtom)(_state_atoms_replay__WEBPACK_IMPORTED_MODULE_5__.replayStateAtom);
    const modelInfo = (0,jotai__WEBPACK_IMPORTED_MODULE_9__.useAtomValue)(_state_atoms_ui__WEBPACK_IMPORTED_MODULE_4__.modelInfoAtom);
    // Check if we're in replay mode using the context hook
    const isReplayMode = (0,_hooks_useReplayMode__WEBPACK_IMPORTED_MODULE_8__.useReplayMode)();
    // 保留这个工具函数，但移除自动同步逻辑
    const getSessionIdFromUrl = (0,react__WEBPACK_IMPORTED_MODULE_7__.useCallback)(()=>{
        const pathParts = location.pathname.split('/').filter(Boolean);
        return pathParts.length > 0 ? pathParts[0] : null;
    }, [
        location
    ]);
    // Periodic status checking for active session - 在回放模式下不检查状态
    (0,react__WEBPACK_IMPORTED_MODULE_7__.useEffect)(()=>{
        if (!activeSessionId || !connectionStatus.connected || isReplayMode) return;
        // Initial status check when session becomes active
        checkSessionStatus(activeSessionId);
    }, [
        activeSessionId,
        connectionStatus.connected,
        checkSessionStatus,
        isReplayMode
    ]);
    // Enhanced socket handler for session status sync - 在回放模式下不更新状态
    const handleSessionStatusUpdate = (0,react__WEBPACK_IMPORTED_MODULE_7__.useCallback)((status)=>{
        if (status && typeof status.isProcessing === 'boolean' && !isReplayMode) {
            setIsProcessing(status.isProcessing);
        }
    }, [
        setIsProcessing,
        isReplayMode
    ]);
    // Set up socket event handlers when active session changes - 在回放模式下不设置socket事件处理
    (0,react__WEBPACK_IMPORTED_MODULE_7__.useEffect)(()=>{
        if (!activeSessionId || !_services_socketService__WEBPACK_IMPORTED_MODULE_6__.socketService.isConnected() || isReplayMode) return;
        // Join session and listen for status updates
        _services_socketService__WEBPACK_IMPORTED_MODULE_6__.socketService.joinSession(activeSessionId, ()=>{
        /* existing event handling */ }, handleSessionStatusUpdate);
        // Register global status handler
        _services_socketService__WEBPACK_IMPORTED_MODULE_6__.socketService.on('agent-status', handleSessionStatusUpdate);
        return ()=>{
            // Clean up handlers
            _services_socketService__WEBPACK_IMPORTED_MODULE_6__.socketService.off('agent-status', handleSessionStatusUpdate);
        };
    }, [
        activeSessionId,
        handleSessionStatusUpdate,
        isReplayMode
    ]);
    // Auto-show plan when it's first created - 在回放模式下不自动显示计划
    (0,react__WEBPACK_IMPORTED_MODULE_7__.useEffect)(()=>{
        var _plans_activeSessionId;
        if (activeSessionId && ((_plans_activeSessionId = plans[activeSessionId]) === null || _plans_activeSessionId === void 0 ? void 0 : _plans_activeSessionId.hasGeneratedPlan) && !isReplayMode) {
            const currentPlan = plans[activeSessionId];
            // If this is a newly generated plan, automatically show it
            if (currentPlan.steps.length > 0 && currentPlan.steps.every((step)=>!step.done)) {
                setPlanUIState((prev)=>({
                        ...prev,
                        isVisible: true
                    }));
            }
        }
    }, [
        activeSessionId,
        plans,
        setPlanUIState,
        isReplayMode
    ]);
    // Memoize the session state object to avoid unnecessary re-renders
    const sessionState = (0,react__WEBPACK_IMPORTED_MODULE_7__.useMemo)(()=>({
            // State
            sessions,
            activeSessionId,
            messages,
            groupedMessages,
            toolResults,
            streamingToolCalls,
            isProcessing,
            activePanelContent,
            connectionStatus,
            plans,
            replayState,
            modelInfo,
            // Session operations
            loadSessions,
            createSession,
            setActiveSession,
            updateSessionMetadata,
            deleteSession,
            // Message operations
            sendMessage,
            abortQuery,
            // UI operations
            setActivePanelContent,
            // Connection operations
            initConnectionMonitoring,
            checkServerStatus,
            // Status operations
            checkSessionStatus,
            getSessionIdFromUrl
        }), [
        sessions,
        activeSessionId,
        messages,
        groupedMessages,
        toolResults,
        streamingToolCalls,
        isProcessing,
        activePanelContent,
        connectionStatus,
        plans,
        replayState,
        modelInfo,
        loadSessions,
        createSession,
        setActiveSession,
        updateSessionMetadata,
        deleteSession,
        sendMessage,
        abortQuery,
        setActivePanelContent,
        initConnectionMonitoring,
        checkServerStatus,
        checkSessionStatus,
        getSessionIdFromUrl
    ]);
    return sessionState;
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),

},function(__webpack_require__) {
// webpack/runtime/get_full_hash
(() => {
__webpack_require__.h = () => ("85658e044c6de445")
})();

}
);
//# sourceMappingURL=index.8dd4313966d22092.hot-update.js.map