"use strict";
self["webpackHotUpdate_agent_tars_web_ui"]("index", {
"./src/entry.css": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
// extracted by css-extract-rspack-plugin

    if(true) {
      (function() {
        var localsJsonString = undefined;
        // 1749583381390
        var cssReload = (__webpack_require__("../node_modules/.pnpm/@rspack+core@1.3.9_@swc+helpers@0.5.17/node_modules/@rspack/core/dist/cssExtractHmr.js")/* .cssReload */.cssReload)(module.id, {});
        // only invalidate when locals change
        if (
          module.hot.data &&
          module.hot.data.value &&
          module.hot.data.value !== localsJsonString
        ) {
          module.hot.invalidate();
        } else {
          module.hot.accept();
        }
        module.hot.dispose(function(data) {
          data.value = localsJsonString;
          cssReload();
        });
      })();
    }
  

}),
"./src/v2/components/Chat/Message/components/MessageGroup.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  MessageGroup: () => (MessageGroup)
});
/* ESM import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("../node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* ESM import */var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("../node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* ESM import */var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* ESM import */var _index__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/v2/components/Chat/Message/index.tsx");
/* ESM import */var react_icons_fi__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("../node_modules/.pnpm/react-icons@4.12.0_react@18.3.1/node_modules/react-icons/fi/index.esm.js");
/* ESM import */var _utils_formatters__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/v2/utils/formatters.ts");
/* ESM import */var _utils_typeGuards__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/v2/utils/typeGuards.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("../node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.3_react-refresh@0.16.0/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");






/**
 * MessageGroup Component - Groups related messages in a thinking sequence
 *
 * Design principles:
 * - Minimalist design with no avatars or indentation
 * - Clean, full-width message layout
 * - All intermediate thinking steps are always visible
 * - Visual hierarchy emphasizing final answers
 * - Consistent monochromatic styling
 */ const MessageGroup = (param)=>{
    let { messages, isThinking } = param;
    // 不再过滤环境消息，而是将它们保存下来
    const environmentMessages = messages.filter((msg)=>msg.role === 'environment');
    // 过滤用户、助手和最终回答消息
    const conversationMessages = messages.filter((msg)=>msg.role === 'user' || msg.role === 'assistant' || msg.role === 'final_answer');
    // 如果过滤后没有会话消息，则不渲染任何内容
    if (conversationMessages.length === 0) {
        return null;
    }
    // 如果只有一条消息，检查是否需要拆分
    if (conversationMessages.length === 1) {
        const message = conversationMessages[0];
        // 检查是否是包含图片和文本的多模态用户消息
        if (message.role === 'user' && (0,_utils_typeGuards__WEBPACK_IMPORTED_MODULE_4__.isMultimodalContent)(message.content)) {
            const imageContents = message.content.filter((part)=>part.type === 'image_url');
            const textContents = message.content.filter((part)=>part.type === 'text');
            // 只有同时包含图片和文本时才拆分显示
            if (imageContents.length > 0 && textContents.length > 0) {
                return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                    className: "space-y-3",
                    children: [
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                            message: {
                                ...message,
                                content: imageContents,
                                id: `${message.id}-images`
                            }
                        }, `${message.id}-images`, false, {
                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                            lineNumber: 54,
                            columnNumber: 13
                        }, undefined),
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                            message: {
                                ...message,
                                content: textContents,
                                id: `${message.id}-text`
                            }
                        }, `${message.id}-text`, false, {
                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                            lineNumber: 64,
                            columnNumber: 13
                        }, undefined)
                    ]
                }, void 0, true, {
                    fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                    lineNumber: 52,
                    columnNumber: 11
                }, undefined);
            }
        }
        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
            message: conversationMessages[0]
        }, void 0, false, {
            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
            lineNumber: 77,
            columnNumber: 12
        }, undefined);
    }
    // 获取第一条消息 - 通常是用户消息
    const firstMessage = conversationMessages[0];
    // If not a user message, use simplified rendering
    if (firstMessage.role !== 'user') {
        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
            className: "space-y-3",
            children: conversationMessages.map((message, index)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                    message: message,
                    isInGroup: index > 0 && index < conversationMessages.length - 1,
                    isIntermediate: index > 0 && index < conversationMessages.length - 1,
                    shouldDisplayTimestamp: false
                }, message.id, false, {
                    fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                    lineNumber: 88,
                    columnNumber: 11
                }, undefined))
        }, void 0, false, {
            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
            lineNumber: 86,
            columnNumber: 7
        }, undefined);
    }
    // For user-initiated groups, use enhanced rendering with thinking sequence
    const responseMessage = conversationMessages.length > 1 ? conversationMessages[1] : null;
    const intermediateMessages = conversationMessages.slice(2, -1);
    const lastMessage = conversationMessages[conversationMessages.length - 1];
    const hasFinalAnswer = lastMessage.role === 'assistant' && lastMessage.finishReason === 'stop';
    const finalMessage = hasFinalAnswer ? lastMessage : null;
    const hasThinkingSteps = intermediateMessages.length > 0;
    // 检查用户消息是否需要拆分
    if ((0,_utils_typeGuards__WEBPACK_IMPORTED_MODULE_4__.isMultimodalContent)(firstMessage.content)) {
        const imageContents = firstMessage.content.filter((part)=>part.type === 'image_url');
        const textContents = firstMessage.content.filter((part)=>part.type === 'text');
        // 只有同时包含图片和文本时才拆分显示
        if (imageContents.length > 0 && textContents.length > 0) {
            return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                className: "message-group-container space-y-3",
                children: [
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                        message: {
                            ...firstMessage,
                            content: imageContents,
                            id: `${firstMessage.id}-images`
                        }
                    }, void 0, false, {
                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                        lineNumber: 121,
                        columnNumber: 11
                    }, undefined),
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                        message: {
                            ...firstMessage,
                            content: textContents,
                            id: `${firstMessage.id}-text`
                        }
                    }, void 0, false, {
                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                        lineNumber: 130,
                        columnNumber: 11
                    }, undefined),
                    responseMessage && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                        className: "assistant-response-container",
                        children: [
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                                message: responseMessage,
                                isInGroup: true
                            }, void 0, false, {
                                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                lineNumber: 142,
                                columnNumber: 15
                            }, undefined),
                            hasThinkingSteps && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                className: "thinking-steps-container",
                                children: [
                                    intermediateMessages.map((msg)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                                            message: msg,
                                            isIntermediate: true,
                                            isInGroup: true
                                        }, msg.id, false, {
                                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                            lineNumber: 148,
                                            columnNumber: 21
                                        }, undefined)),
                                    environmentMessages.length > 0 && !isThinking && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                        className: "environment-input-container",
                                        children: environmentMessages.map((envMsg)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                                                message: envMsg
                                            }, envMsg.id, false, {
                                                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                                lineNumber: 155,
                                                columnNumber: 25
                                            }, undefined))
                                    }, void 0, false, {
                                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                        lineNumber: 153,
                                        columnNumber: 21
                                    }, undefined),
                                    !isThinking && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                        className: "mt-1 mb-2",
                                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                            className: "flex items-center text-xs text-gray-500 dark:text-gray-400 py-1",
                                            children: [
                                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_icons_fi__WEBPACK_IMPORTED_MODULE_5__.FiClock, {
                                                    size: 10,
                                                    className: "mr-1"
                                                }, void 0, false, {
                                                    fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                                    lineNumber: 163,
                                                    columnNumber: 25
                                                }, undefined),
                                                responseMessage && (0,_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.formatTimestamp)(responseMessage.timestamp)
                                            ]
                                        }, void 0, true, {
                                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                            lineNumber: 162,
                                            columnNumber: 23
                                        }, undefined)
                                    }, void 0, false, {
                                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                        lineNumber: 161,
                                        columnNumber: 21
                                    }, undefined)
                                ]
                            }, void 0, true, {
                                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                lineNumber: 146,
                                columnNumber: 17
                            }, undefined),
                            !hasThinkingSteps && environmentMessages.length > 0 && !isThinking && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                className: "environment-input-container mt-3",
                                children: environmentMessages.map((envMsg)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                                        message: envMsg
                                    }, envMsg.id, false, {
                                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                        lineNumber: 175,
                                        columnNumber: 21
                                    }, undefined))
                            }, void 0, false, {
                                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                lineNumber: 173,
                                columnNumber: 17
                            }, undefined),
                            finalMessage && finalMessage !== responseMessage && !isThinking && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                                message: finalMessage,
                                isInGroup: false
                            }, void 0, false, {
                                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                lineNumber: 182,
                                columnNumber: 17
                            }, undefined),
                            isThinking && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                className: "mt-2 flex items-center text-xs text-gray-500 dark:text-gray-400",
                                children: [
                                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                        className: "flex items-center justify-center bg-gray-50/70 dark:bg-gray-700/40 rounded-full w-5 h-5 mr-2 text-gray-500 dark:text-gray-400",
                                        children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                            className: "w-1.5 h-1.5 bg-gray-500 dark:bg-gray-400 rounded-full animate-pulse"
                                        }, void 0, false, {
                                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                            lineNumber: 189,
                                            columnNumber: 21
                                        }, undefined)
                                    }, void 0, false, {
                                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                        lineNumber: 188,
                                        columnNumber: 19
                                    }, undefined),
                                    "Agent TARS is thinking..."
                                ]
                            }, void 0, true, {
                                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                lineNumber: 187,
                                columnNumber: 17
                            }, undefined)
                        ]
                    }, void 0, true, {
                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                        lineNumber: 140,
                        columnNumber: 13
                    }, undefined)
                ]
            }, void 0, true, {
                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                lineNumber: 119,
                columnNumber: 9
            }, undefined);
        }
    }
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
        className: "message-group-container space-y-3",
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                message: firstMessage
            }, void 0, false, {
                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                lineNumber: 204,
                columnNumber: 7
            }, undefined),
            responseMessage && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                className: "assistant-response-container",
                children: [
                    /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                        message: responseMessage,
                        isInGroup: true
                    }, void 0, false, {
                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                        lineNumber: 210,
                        columnNumber: 11
                    }, undefined),
                    hasThinkingSteps && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                        className: "thinking-steps-container",
                        children: [
                            intermediateMessages.map((msg)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                                    message: msg,
                                    isIntermediate: true,
                                    isInGroup: true
                                }, msg.id, false, {
                                    fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                    lineNumber: 216,
                                    columnNumber: 17
                                }, undefined)),
                            environmentMessages.length > 0 && !isThinking && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                className: "environment-input-container",
                                children: environmentMessages.map((envMsg)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                                        message: envMsg
                                    }, envMsg.id, false, {
                                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                        lineNumber: 223,
                                        columnNumber: 21
                                    }, undefined))
                            }, void 0, false, {
                                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                lineNumber: 221,
                                columnNumber: 17
                            }, undefined),
                            !isThinking && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                className: "mt-1 mb-2",
                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                    className: "flex items-center text-xs text-gray-500 dark:text-gray-400 py-1",
                                    children: [
                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_icons_fi__WEBPACK_IMPORTED_MODULE_5__.FiClock, {
                                            size: 10,
                                            className: "mr-1"
                                        }, void 0, false, {
                                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                            lineNumber: 231,
                                            columnNumber: 21
                                        }, undefined),
                                        responseMessage && (0,_utils_formatters__WEBPACK_IMPORTED_MODULE_3__.formatTimestamp)(responseMessage.timestamp)
                                    ]
                                }, void 0, true, {
                                    fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                    lineNumber: 230,
                                    columnNumber: 19
                                }, undefined)
                            }, void 0, false, {
                                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                lineNumber: 229,
                                columnNumber: 17
                            }, undefined)
                        ]
                    }, void 0, true, {
                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                        lineNumber: 214,
                        columnNumber: 13
                    }, undefined),
                    !hasThinkingSteps && environmentMessages.length > 0 && !isThinking && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                        className: "environment-input-container mt-3",
                        children: environmentMessages.map((envMsg)=>/*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                                message: envMsg
                            }, envMsg.id, false, {
                                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                lineNumber: 243,
                                columnNumber: 17
                            }, undefined))
                    }, void 0, false, {
                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                        lineNumber: 241,
                        columnNumber: 13
                    }, undefined),
                    finalMessage && finalMessage !== responseMessage && !isThinking && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_index__WEBPACK_IMPORTED_MODULE_2__.Message, {
                        message: finalMessage,
                        isInGroup: false
                    }, void 0, false, {
                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                        lineNumber: 250,
                        columnNumber: 13
                    }, undefined),
                    isThinking && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                        className: "mt-2 flex items-center text-xs text-gray-500 dark:text-gray-400",
                        children: [
                            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                className: "flex items-center justify-center bg-gray-50/70 dark:bg-gray-700/40 rounded-full w-5 h-5 mr-2 text-gray-500 dark:text-gray-400",
                                children: /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                                    className: "w-1.5 h-1.5 bg-gray-500 dark:bg-gray-400 rounded-full animate-pulse"
                                }, void 0, false, {
                                    fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                    lineNumber: 257,
                                    columnNumber: 17
                                }, undefined)
                            }, void 0, false, {
                                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                                lineNumber: 256,
                                columnNumber: 15
                            }, undefined),
                            "Agent TARS is thinking..."
                        ]
                    }, void 0, true, {
                        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                        lineNumber: 255,
                        columnNumber: 13
                    }, undefined)
                ]
            }, void 0, true, {
                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
                lineNumber: 208,
                columnNumber: 9
            }, undefined)
        ]
    }, void 0, true, {
        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/components/MessageGroup.tsx",
        lineNumber: 202,
        columnNumber: 5
    }, undefined);
};
_c = MessageGroup;
var _c;
$RefreshReg$(_c, "MessageGroup");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),
"./src/v2/state/atoms/message.ts": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  groupedMessagesAtom: () => (groupedMessagesAtom),
  messagesAtom: () => (messagesAtom)
});
/* ESM import */var jotai__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("../node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/vanilla.mjs");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("../node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.3_react-refresh@0.16.0/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

/**
 * Atom for storing messages for each session
 * Key is the session ID, value is an array of messages for that session
 */ const messagesAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_0__.atom)({});
/**
 * Atom for storing grouped messages for each session
 * Key is the session ID, value is an array of message groups for that session
 * This is derived from messagesAtom but with messages properly grouped
 */ const groupedMessagesAtom = (0,jotai__WEBPACK_IMPORTED_MODULE_0__.atom)((get)=>{
    const allMessages = get(messagesAtom);
    const result = {};
    // Process each session's messages into groups
    Object.entries(allMessages).forEach((param)=>{
        let [sessionId, messages] = param;
        result[sessionId] = createMessageGroups(messages);
    });
    return result;
});
/**
 * Group messages into logical conversation groups
 *
 * The grouping logic creates groups based on:
 * 1. User messages always start a new group
 * 2. System messages are standalone groups
 * 3. Assistant/environment messages that belong together are grouped
 * 4. Thinking/processing sequences are properly maintained
 * 5. Environment messages are kept with their related conversation groups
 */ function createMessageGroups(messages) {
    if (!messages.length) return [];
    const groups = [];
    let currentGroup = [];
    let currentThinkingSequence = null;
    // Process messages in order
    for(let i = 0; i < messages.length; i++){
        const message = messages[i];
        // User messages always start a new group
        if (message.role === 'user') {
            if (currentGroup.length > 0) {
                groups.push({
                    messages: [
                        ...currentGroup
                    ]
                });
            }
            currentGroup = [
                message
            ];
            currentThinkingSequence = null;
            continue;
        }
        // System messages are standalone
        if (message.role === 'system') {
            if (currentGroup.length > 0) {
                groups.push({
                    messages: [
                        ...currentGroup
                    ]
                });
            }
            groups.push({
                messages: [
                    message
                ]
            });
            currentGroup = [];
            currentThinkingSequence = null;
            continue;
        }
        // Process assistant and environment messages
        if (message.role === 'assistant' || message.role === 'environment' || message.role === 'final_answer') {
            // Check if this is the start of a thinking sequence
            if (message.role === 'assistant' && currentGroup.length > 0 && currentGroup[currentGroup.length - 1].role === 'user' && (!message.finishReason || message.finishReason !== 'stop')) {
                // Create new thinking sequence
                currentThinkingSequence = {
                    startIndex: currentGroup.length,
                    messages: [
                        message
                    ]
                };
                currentGroup.push(message);
                continue;
            }
            // Continue existing thinking sequence
            if (currentThinkingSequence && (!message.finishReason || message.finishReason !== 'stop')) {
                currentThinkingSequence.messages.push(message);
                currentGroup.push(message);
                continue;
            }
            // Handle final answer in a thinking sequence
            if ((message.role === 'assistant' || message.role === 'final_answer') && message.finishReason === 'stop') {
                if (currentThinkingSequence) {
                    currentThinkingSequence.messages.push(message);
                    currentGroup.push(message);
                    currentThinkingSequence = null;
                    continue;
                } else {
                    // Standalone final answer
                    currentGroup.push(message);
                    continue;
                }
            }
            // Always include environment messages in the current group
            currentGroup.push(message);
        }
    }
    // Add the last group if not empty
    if (currentGroup.length > 0) {
        groups.push({
            messages: [
                ...currentGroup
            ]
        });
    }
    return groups;
}

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),

},function(__webpack_require__) {
// webpack/runtime/get_full_hash
(() => {
__webpack_require__.h = () => ("019bf61ea4c27047")
})();

}
);
//# sourceMappingURL=index.4a481c3ad7029aba.hot-update.js.map