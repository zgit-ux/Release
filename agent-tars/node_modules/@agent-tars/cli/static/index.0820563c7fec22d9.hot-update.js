"use strict";
self["webpackHotUpdate_agent_tars_web_ui"]("index", {
"./src/entry.css": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
// extracted by css-extract-rspack-plugin

    if(true) {
      (function() {
        var localsJsonString = undefined;
        // 1749652565383
        var cssReload = (__webpack_require__("../node_modules/.pnpm/@rspack+core@1.3.9_@swc+helpers@0.5.17/node_modules/@rspack/core/dist/cssExtractHmr.js")/* .cssReload */.cssReload)(module.id, {});
        // only invalidate when locals change
        if (
          module.hot.data &&
          module.hot.data.value &&
          module.hot.data.value !== localsJsonString
        ) {
          module.hot.invalidate();
        } else {
          module.hot.accept();
        }
        module.hot.dispose(function(data) {
          data.value = localsJsonString;
          cssReload();
        });
      })();
    }
  

}),
"./src/v2/components/Chat/Message/index.tsx": (function (module, __webpack_exports__, __webpack_require__) {
__webpack_require__.r(__webpack_exports__);
__webpack_require__.d(__webpack_exports__, {
  Message: () => (Message)
});
/* ESM import */var react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__("../node_modules/.pnpm/react@18.3.1/node_modules/react/jsx-dev-runtime.js");
/* ESM import */var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__("../node_modules/.pnpm/react@18.3.1/node_modules/react/index.js");
/* ESM import */var react__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(react__WEBPACK_IMPORTED_MODULE_1__);
/* ESM import */var framer_motion__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__("../node_modules/.pnpm/framer-motion@10.18.0_react-dom@18.3.1_react@18.3.1__react@18.3.1/node_modules/framer-motion/dist/es/render/dom/motion.mjs");
/* ESM import */var _utils_typeGuards__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__("./src/v2/utils/typeGuards.ts");
/* ESM import */var _hooks_useSession__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__("./src/v2/hooks/useSession.ts");
/* ESM import */var _hooks_useTool__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__("./src/v2/hooks/useTool.tsx");
/* ESM import */var _Markdown__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__("./src/v2/components/Markdown/index.tsx");
/* ESM import */var _Message_css__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__("./src/v2/components/Chat/Message/Message.css");
/* ESM import */var _components_SystemMessage__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__("./src/v2/components/Chat/Message/components/SystemMessage.tsx");
/* ESM import */var _components_EnvironmentMessage__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__("./src/v2/components/Chat/Message/components/EnvironmentMessage.tsx");
/* ESM import */var _components_MultimodalContent__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__("./src/v2/components/Chat/Message/components/MultimodalContent.tsx");
/* ESM import */var _components_AssistantExpandableContent__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__("./src/v2/components/Chat/Message/components/AssistantExpandableContent.tsx");
/* ESM import */var _components_ToolCalls__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__("./src/v2/components/Chat/Message/components/ToolCalls.tsx");
/* ESM import */var _components_ThinkingToggle__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__("./src/v2/components/Chat/Message/components/ThinkingToggle.tsx");
/* ESM import */var _components_MessageTimestamp__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__("./src/v2/components/Chat/Message/components/MessageTimestamp.tsx");
/* ESM import */var jotai__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__("../node_modules/.pnpm/jotai@2.12.5_@types+react@18.3.23_react@18.3.1/node_modules/jotai/esm/react.mjs");
/* ESM import */var _state_atoms_replay__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__("./src/v2/state/atoms/replay.ts");
/* ESM import */var _components_ReportFileEntry__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__("./src/v2/components/Chat/Message/components/ReportFileEntry.tsx");
/* ESM import */var _state_atoms_message__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__("./src/v2/state/atoms/message.ts");
/* provided dependency */ var $ReactRefreshRuntime$ = __webpack_require__("../node_modules/.pnpm/@rspack+plugin-react-refresh@1.0.3_react-refresh@0.16.0/node_modules/@rspack/plugin-react-refresh/client/reactRefresh.js");

var _s = $RefreshSig$();







// Import sub-components











/**
 * Message Component - Displays a single message in the chat
 *
 * Design principles:
 * - Minimalist black & white design with no avatars
 * - Clean, full-width message bubbles with subtle differentiation
 * - Focus on content with minimal visual distractions
 * - Elegant spacing and typography
 * - Progressive disclosure for detailed content
 */ const Message = (param)=>{
    let { message, isIntermediate = false, isInGroup = false, shouldDisplayTimestamp = true } = param;
    _s();
    const [showThinking, setShowThinking] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);
    const [showSteps, setShowSteps] = (0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(false);
    const { setActivePanelContent, activeSessionId } = (0,_hooks_useSession__WEBPACK_IMPORTED_MODULE_3__.useSession)();
    const { getToolIcon } = (0,_hooks_useTool__WEBPACK_IMPORTED_MODULE_4__.useTool)();
    const replayState = (0,jotai__WEBPACK_IMPORTED_MODULE_17__.useAtomValue)(_state_atoms_replay__WEBPACK_IMPORTED_MODULE_14__.replayStateAtom);
    const allMessages = (0,jotai__WEBPACK_IMPORTED_MODULE_17__.useAtomValue)(_state_atoms_message__WEBPACK_IMPORTED_MODULE_16__.messagesAtom);
    const isMultimodal = (0,_utils_typeGuards__WEBPACK_IMPORTED_MODULE_2__.isMultimodalContent)(message.content);
    const isEnvironment = message.role === 'environment';
    const isUserMessage = message.role === 'user';
    const isFinalAnswer = message.role === 'final_answer' || message.isDeepResearch;
    // Check if this is a final assistant response
    const isFinalAssistantResponse = message.role === 'assistant' && message.finishReason === 'stop';
    // Handle tool call click - show in panel
    const handleToolCallClick = (toolCall)=>{
        if (message.toolResults && message.toolResults.length > 0) {
            const result = message.toolResults.find((r)=>r.toolCallId === toolCall.id);
            if (result) {
                setActivePanelContent({
                    type: result.type,
                    source: result.content,
                    title: result.name,
                    timestamp: result.timestamp,
                    toolCallId: result.toolCallId,
                    error: result.error,
                    arguments: result.arguments
                });
            }
        }
    };
    // Handle click on final assistant response to show latest environment state
    const handleFinalResponseClick = ()=>{
        if (!activeSessionId || !isFinalAssistantResponse) return;
        const sessionMessages = allMessages[activeSessionId] || [];
        // Find the most recent environment input
        for(let i = sessionMessages.length - 1; i >= 0; i--){
            const msg = sessionMessages[i];
            if (msg.role === 'environment' && Array.isArray(msg.content)) {
                const imageContent = msg.content.find((item)=>item.type === 'image_url' && item.image_url && item.image_url.url);
                if (imageContent) {
                    setActivePanelContent({
                        type: 'image',
                        source: msg.content,
                        title: msg.description || 'Final Environment State',
                        timestamp: msg.timestamp,
                        environmentId: msg.id
                    });
                    break;
                }
            }
        }
    };
    // Render content based on type
    const renderContent = ()=>{
        if (isMultimodal) {
            return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_MultimodalContent__WEBPACK_IMPORTED_MODULE_9__.MultimodalContent, {
                content: message.content,
                timestamp: message.timestamp,
                setActivePanelContent: setActivePanelContent
            }, void 0, false, {
                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                lineNumber: 113,
                columnNumber: 9
            }, undefined);
        }
        // For assistant messages with tool calls, first show summary
        if (message.role === 'assistant' && message.toolCalls && message.toolCalls.length > 0) {
            return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_AssistantExpandableContent__WEBPACK_IMPORTED_MODULE_10__.AssistantExpandableContent, {
                content: message.content,
                showSteps: showSteps,
                setShowSteps: setShowSteps
            }, void 0, false, {
                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                lineNumber: 124,
                columnNumber: 9
            }, undefined);
        }
        return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_Markdown__WEBPACK_IMPORTED_MODULE_5__.MarkdownRenderer, {
            content: message.content,
            forceDarkTheme: isUserMessage
        }, void 0, false, {
            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
            lineNumber: 132,
            columnNumber: 12
        }, undefined);
    };
    // Message animation variants
    const messageVariants = {
        initial: {
            opacity: 0,
            y: 10
        },
        animate: {
            opacity: 1,
            y: 0
        },
        transition: {
            duration: 0.3
        }
    };
    // Determine message bubble style based on role and state
    const getMessageBubbleClasses = ()=>{
        let baseClasses = '';
        if (message.role === 'user') {
            if (isImageOnlyMessage) {
                baseClasses = 'message-user message-user-image';
            } else {
                baseClasses = 'message-user';
            }
        } else if (message.role === 'system') {
            baseClasses = 'message-system';
        } else if (message.role === 'environment') {
            baseClasses = 'environment-message-minimal';
        } else {
            baseClasses = 'message-assistant';
        }
        // 添加更平滑的点击样式
        if (isFinalAssistantResponse) {
            baseClasses += ' cursor-pointer transition-all duration-300';
        }
        return baseClasses;
    };
    // 检查消息是否只包含图片（用于样式优化）
    const isImageOnlyMessage = react__WEBPACK_IMPORTED_MODULE_1___default().useMemo(()=>{
        if (!(0,_utils_typeGuards__WEBPACK_IMPORTED_MODULE_2__.isMultimodalContent)(message.content)) return false;
        const imageContents = message.content.filter((part)=>part.type === 'image_url');
        const textContents = message.content.filter((part)=>part.type === 'text');
        return imageContents.length > 0 && textContents.length === 0;
    }, [
        message.content
    ]);
    // 检查消息是否只包含文本（用于样式优化）
    const isTextOnlyMessage = react__WEBPACK_IMPORTED_MODULE_1___default().useMemo(()=>{
        if (!(0,_utils_typeGuards__WEBPACK_IMPORTED_MODULE_2__.isMultimodalContent)(message.content)) return true;
        const imageContents = message.content.filter((part)=>part.type === 'image_url');
        const textContents = message.content.filter((part)=>part.type === 'text');
        return textContents.length > 0 && imageContents.length === 0;
    }, [
        message.content
    ]);
    return /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(framer_motion__WEBPACK_IMPORTED_MODULE_18__.motion.div, {
        initial: "initial",
        animate: "animate",
        variants: messageVariants,
        className: `message-container ${message.role === 'user' ? 'message-container-user' : 'message-container-assistant'} ${isIntermediate ? 'message-container-intermediate' : ''}`,
        children: [
            /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                className: `message-bubble ${getMessageBubbleClasses()} ${isIntermediate ? 'message-bubble-intermediate' : ''} ${isFinalAssistantResponse ? 'group' : ''}`,
                onClick: isFinalAssistantResponse ? handleFinalResponseClick : undefined,
                title: isFinalAssistantResponse ? 'Click to view final environment state' : undefined,
                children: message.role === 'system' ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_SystemMessage__WEBPACK_IMPORTED_MODULE_7__.SystemMessage, {
                    content: message.content
                }, void 0, false, {
                    fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                    lineNumber: 202,
                    columnNumber: 11
                }, undefined) : message.role === 'environment' ? /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_EnvironmentMessage__WEBPACK_IMPORTED_MODULE_8__.EnvironmentMessage, {
                    content: message.content,
                    description: message.description,
                    timestamp: message.timestamp,
                    setActivePanelContent: setActivePanelContent,
                    isIntermediate: isIntermediate
                }, void 0, false, {
                    fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                    lineNumber: 204,
                    columnNumber: 11
                }, undefined) : /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.Fragment, {
                    children: [
                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                            className: `prose ${message.role === 'user' ? 'prose-invert' : 'dark:prose-invert'} prose-sm max-w-none text-sm`,
                            children: renderContent()
                        }, void 0, false, {
                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                            lineNumber: 213,
                            columnNumber: 13
                        }, undefined),
                        isFinalAssistantResponse && !isIntermediate && !isInGroup && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("div", {
                            className: "mt-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 text-xs text-gray-500 dark:text-gray-400 flex items-center",
                            children: [
                                /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("svg", {
                                    width: "14",
                                    height: "14",
                                    viewBox: "0 0 24 24",
                                    fill: "none",
                                    className: "mr-1",
                                    children: [
                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("path", {
                                            d: "M15 3h6v6",
                                            stroke: "currentColor",
                                            strokeWidth: "2",
                                            strokeLinecap: "round",
                                            strokeLinejoin: "round"
                                        }, void 0, false, {
                                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                                            lineNumber: 223,
                                            columnNumber: 19
                                        }, undefined),
                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("path", {
                                            d: "M10 14L21 3",
                                            stroke: "currentColor",
                                            strokeWidth: "2",
                                            strokeLinecap: "round",
                                            strokeLinejoin: "round"
                                        }, void 0, false, {
                                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                                            lineNumber: 230,
                                            columnNumber: 19
                                        }, undefined),
                                        /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)("path", {
                                            d: "M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6",
                                            stroke: "currentColor",
                                            strokeWidth: "2",
                                            strokeLinecap: "round",
                                            strokeLinejoin: "round"
                                        }, void 0, false, {
                                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                                            lineNumber: 237,
                                            columnNumber: 19
                                        }, undefined)
                                    ]
                                }, void 0, true, {
                                    fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                                    lineNumber: 222,
                                    columnNumber: 17
                                }, undefined),
                                "Click to view final environment state"
                            ]
                        }, void 0, true, {
                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                            lineNumber: 221,
                            columnNumber: 15
                        }, undefined),
                        isFinalAnswer && message.title && typeof message.content === 'string' && !isIntermediate && !isInGroup && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ReportFileEntry__WEBPACK_IMPORTED_MODULE_15__.ReportFileEntry, {
                            title: message.title || 'Research Report',
                            timestamp: message.timestamp,
                            content: message.content
                        }, void 0, false, {
                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                            lineNumber: 255,
                            columnNumber: 17
                        }, undefined),
                        message.toolCalls && message.toolCalls.length > 0 && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ToolCalls__WEBPACK_IMPORTED_MODULE_11__.ToolCalls, {
                            toolCalls: message.toolCalls,
                            onToolCallClick: handleToolCallClick,
                            getToolIcon: getToolIcon,
                            isIntermediate: isIntermediate,
                            toolResults: message.toolResults || []
                        }, void 0, false, {
                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                            lineNumber: 264,
                            columnNumber: 15
                        }, undefined),
                        message.thinking && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_ThinkingToggle__WEBPACK_IMPORTED_MODULE_12__.ThinkingToggle, {
                            thinking: message.thinking,
                            showThinking: showThinking,
                            setShowThinking: setShowThinking
                        }, void 0, false, {
                            fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                            lineNumber: 275,
                            columnNumber: 15
                        }, undefined)
                    ]
                }, void 0, true)
            }, void 0, false, {
                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                lineNumber: 195,
                columnNumber: 7
            }, undefined),
            message.role !== 'system' && !isIntermediate && !isInGroup && shouldDisplayTimestamp && !replayState.isActive && /*#__PURE__*/ (0,react_jsx_dev_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxDEV)(_components_MessageTimestamp__WEBPACK_IMPORTED_MODULE_13__.MessageTimestamp, {
                timestamp: message.timestamp,
                content: message.content,
                role: message.role
            }, void 0, false, {
                fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
                lineNumber: 291,
                columnNumber: 11
            }, undefined)
        ]
    }, void 0, true, {
        fileName: "/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Chat/Message/index.tsx",
        lineNumber: 189,
        columnNumber: 5
    }, undefined);
};
_s(Message, "Y+uoWWKnJOzqnhedfoPTfr5eBxk=", false, function() {
    return [
        _hooks_useSession__WEBPACK_IMPORTED_MODULE_3__.useSession,
        _hooks_useTool__WEBPACK_IMPORTED_MODULE_4__.useTool,
        jotai__WEBPACK_IMPORTED_MODULE_17__.useAtomValue,
        jotai__WEBPACK_IMPORTED_MODULE_17__.useAtomValue
    ];
});
_c = Message;
var _c;
$RefreshReg$(_c, "Message");

function $RefreshSig$() {
  return $ReactRefreshRuntime$.createSignatureFunctionForTransform();
}
function $RefreshReg$(type, id) {
  $ReactRefreshRuntime$.register(type, module.id + "_" + id);
}
Promise.resolve().then(function() {
  $ReactRefreshRuntime$.refresh(module.id, module.hot);
});


}),

},function(__webpack_require__) {
// webpack/runtime/get_full_hash
(() => {
__webpack_require__.h = () => ("e82e862381539b0c")
})();

}
);
//# sourceMappingURL=index.0820563c7fec22d9.hot-update.js.map