{"version":3,"file":"index.a38e3c433014d69e.hot-update.js","sources":["/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/entry.css","/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/v2/components/Share/ShareModal.tsx"],"sourcesContent":["// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1748912678982\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.3.9_@swc+helpers@0.5.17/node_modules/@rspack/core/dist/cssExtractHmr.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","import React, { useState, useEffect } from 'react';\nimport { motion } from 'framer-motion';\nimport { FiX, FiShare2, FiLink, FiDownload, FiCheck, FiLoader } from 'react-icons/fi';\nimport { shareService, ShareConfig, ShareResult } from '../../services/shareService';\nimport { Modal, Box } from '@mui/material';\n\ninterface ShareModalProps {\n  isOpen: boolean;\n  onClose: () => void;\n  sessionId: string;\n}\n\nexport const ShareModal: React.FC<ShareModalProps> = ({ isOpen, onClose, sessionId }) => {\n  const [shareConfig, setShareConfig] = useState<ShareConfig | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [shareResult, setShareResult] = useState<ShareResult | null>(null);\n  const [copied, setCopied] = useState(false);\n\n  // 获取分享配置\n  useEffect(() => {\n    if (isOpen) {\n      const fetchConfig = async () => {\n        try {\n          const config = await shareService.getShareConfig();\n          setShareConfig(config);\n        } catch (error) {\n          console.error('Failed to get share config:', error);\n          // 设置默认配置\n          setShareConfig({ hasShareProvider: false, shareProvider: null });\n        }\n      };\n\n      fetchConfig();\n    }\n  }, [isOpen]);\n\n  // 当模态框关闭时重置状态，允许重新分享\n  useEffect(() => {\n    if (!isOpen) {\n      setShareResult(null);\n    }\n  }, [isOpen]);\n\n  // 处理上传分享\n  const handleUpload = async () => {\n    if (!sessionId || !shareConfig) return;\n\n    setIsLoading(true);\n    setShareResult(null);\n\n    try {\n      const result = await shareService.shareSession(sessionId, true);\n      setShareResult(result);\n    } catch (error) {\n      console.error('Failed to share session:', error);\n      setShareResult({\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // 处理下载分享\n  const handleDownload = async () => {\n    if (!sessionId) return;\n\n    setIsLoading(true);\n    setShareResult(null);\n\n    try {\n      const result = await shareService.shareSession(sessionId, false);\n      setShareResult(result);\n\n      if (result.success && result.html) {\n        shareService.downloadShareHtml(result.html, sessionId);\n      }\n    } catch (error) {\n      console.error('Failed to download share HTML:', error);\n      setShareResult({\n        success: false,\n        error: error instanceof Error ? error.message : String(error),\n      });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // 复制分享链接\n  const handleCopyLink = () => {\n    if (shareResult?.url) {\n      navigator.clipboard.writeText(shareResult.url);\n      setCopied(true);\n      setTimeout(() => setCopied(false), 2000);\n    }\n  };\n\n  return (\n    <Modal\n      open={isOpen}\n      onClose={onClose}\n      aria-labelledby=\"share-modal-title\"\n      aria-describedby=\"share-modal-description\"\n      sx={{\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        backdropFilter: 'blur(5px)',\n      }}\n    >\n      <Box\n        sx={{\n          position: 'relative',\n          width: '100%',\n          maxWidth: '480px',\n          bgcolor: 'background.paper',\n          borderRadius: '24px',\n          boxShadow: 24,\n          p: 4,\n          outline: 'none',\n          mx: 2,\n        }}\n        className=\"dark:bg-gray-800 border border-[#E5E6EC] dark:border-gray-700/30\"\n      >\n        {/* 标题和关闭按钮 */}\n        <div className=\"flex items-center justify-between mb-6\">\n          <h3 className=\"text-xl font-medium text-gray-800 dark:text-gray-200 flex items-center\" id=\"share-modal-title\">\n            <FiShare2 className=\"mr-3 text-gray-500 dark:text-gray-400\" />\n            Share Conversation\n          </h3>\n          <motion.button\n            whileHover={{ scale: 1.1 }}\n            whileTap={{ scale: 0.9 }}\n            onClick={onClose}\n            className=\"p-2 rounded-full text-gray-500 hover:bg-gray-100 dark:hover:bg-gray-700/50 transition-colors\"\n          >\n            <FiX size={20} />\n          </motion.button>\n        </div>\n\n        {/* 正在加载配置 */}\n        {!shareConfig && (\n          <div className=\"flex items-center justify-center py-8\">\n            <div className=\"flex items-center space-x-2 text-gray-500 dark:text-gray-400\">\n              <motion.div\n                animate={{ rotate: 360 }}\n                transition={{ duration: 1, repeat: Infinity, ease: 'linear' }}\n              >\n                <FiLoader size={20} />\n              </motion.div>\n              <span>Loading share options...</span>\n            </div>\n          </div>\n        )}\n\n        {/* 分享选项 */}\n        {shareConfig && !isLoading && !shareResult && (\n          <div className=\"space-y-6\">\n            <p className=\"text-gray-600 dark:text-gray-400 text-sm\">\n              Choose how you want to share this conversation:\n            </p>\n\n            <div className=\"space-y-4\">\n              {/* 上传选项 - 仅当配置了分享提供者时显示 */}\n              {shareConfig.hasShareProvider && (\n                <motion.button\n                  whileHover={{ y: -2 }}\n                  whileTap={{ scale: 0.98 }}\n                  onClick={handleUpload}\n                  className=\"w-full flex items-center justify-between p-4 bg-white dark:bg-gray-800 rounded-xl border border-[#E5E6EC] dark:border-gray-700/30 hover:border-gray-300 dark:hover:border-gray-600/70 transition-all duration-200\"\n                >\n                  <div className=\"flex items-center\">\n                    <div className=\"w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-gray-700 dark:text-gray-300 mr-3\">\n                      <FiLink size={20} />\n                    </div>\n                    <div className=\"text-left\">\n                      <h4 className=\"font-medium text-gray-800 dark:text-gray-200\">\n                        Get shareable link\n                      </h4>\n                      <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                        Upload and get a link to share\n                      </p>\n                    </div>\n                  </div>\n                  <div className=\"w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center\">\n                    <FiShare2 size={16} className=\"text-gray-500 dark:text-gray-400\" />\n                  </div>\n                </motion.button>\n              )}\n\n              {/* 下载选项 - 始终显示 */}\n              <motion.button\n                whileHover={{ y: -2 }}\n                whileTap={{ scale: 0.98 }}\n                onClick={handleDownload}\n                className=\"w-full flex items-center justify-between p-4 bg-white dark:bg-gray-800 rounded-xl border border-[#E5E6EC] dark:border-gray-700/30 hover:border-gray-300 dark:hover:border-gray-600/70 transition-all duration-200\"\n              >\n                <div className=\"flex items-center\">\n                  <div className=\"w-10 h-10 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center text-gray-700 dark:text-gray-300 mr-3\">\n                    <FiDownload size={20} />\n                  </div>\n                  <div className=\"text-left\">\n                    <h4 className=\"font-medium text-gray-800 dark:text-gray-200\">\n                      Download HTML\n                    </h4>\n                    <p className=\"text-xs text-gray-500 dark:text-gray-400\">\n                      Save the conversation as HTML file\n                    </p>\n                  </div>\n                </div>\n                <div className=\"w-8 h-8 rounded-full bg-gray-100 dark:bg-gray-700 flex items-center justify-center\">\n                  <FiDownload size={16} className=\"text-gray-500 dark:text-gray-400\" />\n                </div>\n              </motion.button>\n            </div>\n\n            <p className=\"text-xs text-gray-500 dark:text-gray-400 text-center\">\n              Sharing includes all messages and tool results in this conversation.\n            </p>\n          </div>\n        )}\n\n        {/* 加载状态 */}\n        {isLoading && (\n          <div className=\"flex flex-col items-center justify-center py-10\">\n            <motion.div\n              animate={{ rotate: 360 }}\n              transition={{ duration: 2, repeat: Infinity, ease: 'linear' }}\n              className=\"w-12 h-12 rounded-full border-2 border-gray-200 dark:border-gray-700 border-t-gray-600 dark:border-t-gray-300 mb-4\"\n            />\n            <p className=\"text-gray-700 dark:text-gray-300 text-center\">\n              Preparing your conversation for sharing...\n            </p>\n          </div>\n        )}\n\n        {/* 分享结果 - 成功 */}\n        {shareResult && shareResult.success && shareResult.url && (\n          <div className=\"space-y-6\">\n            <div className=\"bg-green-50/50 dark:bg-green-900/20 rounded-xl p-4 border border-green-100/60 dark:border-green-800/30 flex items-start\">\n              <div className=\"w-8 h-8 rounded-full bg-green-100 dark:bg-green-800/40 flex items-center justify-center flex-shrink-0 mr-3\">\n                <FiCheck className=\"text-green-600 dark:text-green-400\" size={16} />\n              </div>\n              <div>\n                <p className=\"font-medium text-gray-800 dark:text-gray-200\">\n                  Share link created!\n                </p>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                  Your conversation is now available at the link below.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"relative\">\n              <input\n                type=\"text\"\n                value={shareResult.url}\n                readOnly\n                className=\"w-full pr-24 pl-4 py-3 bg-gray-50 dark:bg-gray-700/60 rounded-xl border border-[#E5E6EC] dark:border-gray-700/30 text-gray-800 dark:text-gray-200 text-sm focus:outline-none\"\n              />\n              <button\n                onClick={handleCopyLink}\n                className=\"absolute right-1.5 top-1.5 px-3 py-1.5 bg-gray-100 dark:bg-gray-700 hover:bg-gray-200 dark:hover:bg-gray-600 rounded-lg text-xs font-medium text-gray-700 dark:text-gray-300 transition-colors\"\n              >\n                {copied ? (\n                  <span className=\"flex items-center\">\n                    <FiCheck className=\"mr-1\" size={12} />\n                    Copied!\n                  </span>\n                ) : (\n                  'Copy Link'\n                )}\n              </button>\n            </div>\n\n            <p className=\"text-xs text-gray-500 dark:text-gray-400 text-center\">\n              This link will be accessible to anyone who has it.\n            </p>\n\n            <div className=\"flex justify-end\">\n              <motion.button\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                onClick={onClose}\n                className=\"px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-xl text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors\"\n              >\n                Close\n              </motion.button>\n            </div>\n          </div>\n        )}\n\n        {/* 分享结果 - 下载HTML成功 */}\n        {shareResult && shareResult.success && shareResult.html && (\n          <div className=\"space-y-6\">\n            <div className=\"bg-green-50/50 dark:bg-green-900/20 rounded-xl p-4 border border-green-100/60 dark:border-green-800/30 flex items-start\">\n              <div className=\"w-8 h-8 rounded-full bg-green-100 dark:bg-green-800/40 flex items-center justify-center flex-shrink-0 mr-3\">\n                <FiCheck className=\"text-green-600 dark:text-green-400\" size={16} />\n              </div>\n              <div>\n                <p className=\"font-medium text-gray-800 dark:text-gray-200\">\n                  HTML file downloaded!\n                </p>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                  The HTML file contains all messages and tool results from this conversation.\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex justify-end\">\n              <motion.button\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                onClick={onClose}\n                className=\"px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-xl text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors\"\n              >\n                Close\n              </motion.button>\n            </div>\n          </div>\n        )}\n\n        {/* 分享结果 - 错误 */}\n        {shareResult && !shareResult.success && (\n          <div className=\"space-y-6\">\n            <div className=\"bg-red-50/50 dark:bg-red-900/20 rounded-xl p-4 border border-red-100/60 dark:border-red-800/30 flex items-start\">\n              <div className=\"w-8 h-8 rounded-full bg-red-100 dark:bg-red-800/40 flex items-center justify-center flex-shrink-0 mr-3\">\n                <FiX className=\"text-red-600 dark:text-red-400\" size={16} />\n              </div>\n              <div>\n                <p className=\"font-medium text-gray-800 dark:text-gray-200\">Failed to share</p>\n                <p className=\"text-sm text-gray-600 dark:text-gray-400 mt-1\">\n                  {shareResult.error ||\n                    'An error occurred while trying to share the conversation.'}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex justify-end\">\n              <motion.button\n                whileHover={{ scale: 1.02 }}\n                whileTap={{ scale: 0.98 }}\n                onClick={onClose}\n                className=\"px-4 py-2 bg-gray-100 dark:bg-gray-700 rounded-xl text-sm font-medium text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors\"\n              >\n                Close\n              </motion.button>\n            </div>\n          </div>\n        )}\n      </Box>\n    </Modal>\n  );\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACvBA;AACA;AACA;AACA;AACA;AAQA;AAAA;;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AACA;AACA;AACA;AAAA;AAAA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAEA;AACA;AAEA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAGA;AAAA;;AACA;AAAA;AAAA;;AACA;AAAA;;;;;;AAAA;;;;;;;AAGA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AAAA;;;;;;;;;;;;;;;;;AAKA;AACA;AACA;AAAA;;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;;;;;;;;;;;AAEA;AAAA;;;;;;;;;;;;;;;;;AAMA;AACA;;AACA;AAAA;AAAA;;;;;;AAIA;AAAA;;AAEA;AAEA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;;AAEA;AAAA;;AACA;AAAA;AACA;AAAA;;;;;;;;;;;AAEA;AAAA;;AACA;AAAA;AAAA;;;;;;AAGA;AAAA;AAAA;;;;;;;;;;;;;;;;;;AAKA;AAAA;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;AAMA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;;AAEA;AAAA;;AACA;AAAA;AACA;AAAA;;;;;;;;;;;AAEA;AAAA;;AACA;AAAA;AAAA;;;;;;AAGA;AAAA;AAAA;;;;;;;;;;;;;;;;;;AAKA;AAAA;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;AAKA;AAAA;AAAA;;;;;;;;;;;;AAOA;AACA;;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;AAEA;AAAA;AAAA;;;;;;;;;;;;AAOA;AACA;;AACA;AAAA;;AACA;AAAA;AACA;AAAA;AAAA;;;;;;;;;;;AAEA;;AACA;AAAA;AAAA;;;;;;AAGA;AAAA;AAAA;;;;;;;;;;;;;;;;;;AAMA;AAAA;;AACA;AACA;AACA;AACA;AACA;;;;;;AAEA;AACA;AACA;AAEA;AACA;;AACA;AAAA;AAAA;;;;;;AAAA;;;;;;AAIA;;;;;;;;;;;;AAKA;AAAA;AAAA;;;;;;AAIA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AAQA;AACA;;AACA;AAAA;;AACA;AAAA;AACA;AAAA;AAAA;;;;;;;;;;;AAEA;;AACA;AAAA;AAAA;;;;;;AAGA;AAAA;AAAA;;;;;;;;;;;;;;;;;;AAMA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;AAQA;AACA;;AACA;AAAA;;AACA;AAAA;AACA;AAAA;AAAA;;;;;;;;;;;AAEA;;AACA;AAAA;AAAA;;;;;;AACA;AAAA;AACA;;;;;;;;;;;;;;;;;;AAMA;AAAA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AASA;AAtVA;AAAA"}