{"version":3,"file":"index.9c7496427c99ee1b.hot-update.js","sources":["/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/entry.css","/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/main/components/Chat/Message/components/EnvironmentMessage.tsx","/Users/chenhaoli/workspace/code/UI-TARS-desktop-5/multimodal/agent-tars-web-ui/src/main/components/Layout/index.tsx"],"sourcesContent":["// extracted by css-extract-rspack-plugin\nexport {};\n    if(module.hot) {\n      (function() {\n        var localsJsonString = undefined;\n        // 1749662627432\n        var cssReload = require(\"../../node_modules/.pnpm/@rspack+core@1.3.9_@swc+helpers@0.5.17/node_modules/@rspack/core/dist/cssExtractHmr.js\").cssReload(module.id, {});\n        // only invalidate when locals change\n        if (\n          module.hot.data &&\n          module.hot.data.value &&\n          module.hot.data.value !== localsJsonString\n        ) {\n          module.hot.invalidate();\n        } else {\n          module.hot.accept();\n        }\n        module.hot.dispose(function(data) {\n          data.value = localsJsonString;\n          cssReload();\n        });\n      })();\n    }\n  ","import React from 'react';\nimport { motion } from 'framer-motion';\nimport { FiMaximize } from 'react-icons/fi';\nimport { MarkdownRenderer } from '@/sdk/markdown-renderer';\nimport { BrowserShell } from '../../../Workspace/renderers/BrowserShell';\nimport { useSession } from '../../../../hooks/useSession';\n\ninterface EnvironmentMessageProps {\n  content: any;\n  description?: string;\n  timestamp: number;\n  setActivePanelContent: (content: any) => void;\n  isIntermediate?: boolean;\n}\n\n/**\n * Component for displaying environment messages with optimized image rendering\n *\n * Design principles:\n * - Efficient rendering of multi-format content\n * - Interactive image thumbnails with preview capability\n * - Clear visual hierarchy with descriptive labels\n * - Compact and elegant styling for images without borders\n * - Support for intermediate display in thinking sequences\n * - Uses BrowserShell for browser screenshots for consistent UI with browser_vision_control\n */\nexport const EnvironmentMessage: React.FC<EnvironmentMessageProps> = ({\n  content,\n  description,\n  timestamp,\n  setActivePanelContent,\n  isIntermediate = false,\n}) => {\n  const { replayState } = useSession();\n\n  // 处理直接从环境输入渲染图像\n  if (Array.isArray(content)) {\n    const images = content.filter((part) => part.type === 'image_url');\n    const textParts = content.filter((part) => part.type === 'text');\n\n    // 空内容处理\n    if (images.length === 0 && textParts.length === 0) {\n      return <div className=\"text-xs text-gray-500 italic\">环境输入</div>;\n    }\n\n    // 检查是否是浏览器截图 - 通过description判断或使用启发式方法\n    const isBrowserScreenshot =\n      description?.toLowerCase().includes('browser') ||\n      description?.toLowerCase().includes('screenshot') ||\n      // 如果描述包含特定关键词但图片数量较少，可能是浏览器截图\n      (images.length === 1 && !isIntermediate);\n\n    // 确保在回放模式下图片能够正确加载\n    const handleImageError = (e: React.SyntheticEvent<HTMLImageElement, Event>) => {\n      console.warn('Image failed to load:', e.currentTarget.src);\n      // 可以在这里添加重试逻辑或替代图片\n    };\n\n    // 对于浏览器截图，使用BrowserShell进行渲染\n    if (isBrowserScreenshot && images.length > 0) {\n      return (\n        <div className=\"space-y-1\">\n          {/* 渲染文本内容 */}\n          {textParts.length > 0 && (\n            <div\n              className={`prose dark:prose-invert prose-sm max-w-none ${isIntermediate ? 'text-xs' : 'text-sm'} mb-2`}\n            >\n              {textParts.map((part, idx) => (\n                <MarkdownRenderer key={idx} content={part.text} />\n              ))}\n            </div>\n          )}\n\n          {/* 使用BrowserShell渲染浏览器截图 */}\n          <BrowserShell title={description || 'Browser Screenshot'}>\n            <div\n              className=\"relative group cursor-pointer\"\n              onClick={() =>\n                setActivePanelContent({\n                  type: 'image',\n                  source: images[0].image_url.url,\n                  title: description || '浏览器截图',\n                  timestamp,\n                })\n              }\n            >\n              <img\n                src={images[0].image_url.url}\n                alt={images[0].image_url.alt || '截图'}\n                className=\"w-full h-auto object-contain\"\n                onError={handleImageError}\n              />\n\n              {/* 悬停覆盖层 */}\n              <div className=\"absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center\">\n                <FiMaximize className=\"text-white\" size={20} />\n              </div>\n            </div>\n          </BrowserShell>\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"space-y-1\">\n        {/* 渲染文本内容 */}\n        {textParts.length > 0 && (\n          <div\n            className={`prose dark:prose-invert prose-sm max-w-none ${isIntermediate ? 'text-xs' : 'text-sm'}`}\n          >\n            {textParts.map((part, idx) => (\n              <MarkdownRenderer key={idx} content={part.text} />\n            ))}\n          </div>\n        )}\n\n        {/* 将图像渲染为无边框的缩略图 */}\n        {images.length > 0 && (\n          <div className=\"flex flex-wrap gap-1 mt-1\">\n            {images.map((image, idx) => (\n              <motion.div\n                key={idx}\n                whileHover={{ scale: 1.02 }}\n                className=\"relative group cursor-pointer\"\n                onClick={() =>\n                  setActivePanelContent({\n                    type: 'image',\n                    source: image.image_url.url,\n                    title: description || '环境输入',\n                    timestamp,\n                  })\n                }\n              >\n                {/* 缩略图 */}\n                <img\n                  src={image.image_url.url}\n                  alt={image.image_url.alt || '截图'}\n                  className={`${isIntermediate ? 'h-16' : 'h-20'} rounded-lg object-cover shadow-sm`}\n                  onError={handleImageError}\n                />\n\n                {/* 悬停覆盖层 */}\n                <div className=\"absolute inset-0 bg-black/20 opacity-0 group-hover:opacity-100 rounded-lg transition-opacity duration-200 flex items-center justify-center\">\n                  <FiMaximize className=\"text-white\" size={isIntermediate ? 14 : 16} />\n                </div>\n              </motion.div>\n            ))}\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  // 非数组内容的回退\n  return (\n    <div\n      className={`prose dark:prose-invert prose-sm max-w-none ${isIntermediate ? 'text-xs' : 'text-sm'}`}\n    >\n      {description && !isIntermediate && (\n        <div className=\"text-xs font-medium text-gray-500 dark:text-gray-400 mb-1\">\n          {description}\n        </div>\n      )}\n      {typeof content === 'string' ? (\n        <MarkdownRenderer content={content} />\n      ) : (\n        <pre className=\"text-xs\">{JSON.stringify(content, null, 2)}</pre>\n      )}\n    </div>\n  );\n};\n","import React from 'react';\nimport { Sidebar } from '@/standalone/sidebar';\nimport { Navbar } from '@/standalone/navbar';\nimport { ChatPanel } from '../Chat/ChatPanel';\nimport { WorkspacePanel } from '../Workspace/WorkspacePanel';\nimport { useSession } from '../../hooks/useSession';\nimport { motion } from 'framer-motion';\nimport { Shell } from './Shell';\nimport { useReplayMode } from '../../hooks/useReplayMode';\nimport './Layout.css';\n\ninterface LayoutProps {\n  isReplayMode?: boolean;\n}\n\n/**\n * Layout Component - Main application layout\n *\n * Design principles:\n * - Clean, minimalist aesthetic with refined borders and subtle shadows\n * - Neutral color palette with elegant accent colors\n * - Consistent spacing and typography for optimal readability\n * - Seamless visual flow between different interface elements\n * - Adapts layout based on replay mode status\n */\nexport const Layout: React.FC<LayoutProps> = ({ isReplayMode: propIsReplayMode }) => {\n  const { connectionStatus } = useSession();\n\n  // Use the context hook to get global replay mode status\n  const contextIsReplayMode = useReplayMode();\n\n  // Prioritize props for backward compatibility, but fall back to context\n  const isReplayMode = propIsReplayMode !== undefined ? propIsReplayMode : contextIsReplayMode;\n\n  return (\n    <div className=\"flex flex-col h-screen bg-[#F2F3F5] dark:bg-white/5 text-gray-900 dark:text-gray-100 overflow-hidden\">\n      {/* Global navbar at the top */}\n      <Navbar />\n\n      {/* Main content area */}\n      <div className=\"flex flex-1 overflow-hidden\">\n        {/* Sidebar with ToolBar and ChatSession - only show when not in replay mode */}\n        {!isReplayMode && <Sidebar />}\n\n        {/* Content area - using flex-col to properly distribute vertical space */}\n        <div className=\"flex-1 flex flex-col overflow-hidden p-2 lg:p-3\">\n          {/* Panels container - apply flex-1 to take remaining vertical space */}\n          <div className=\"flex gap-3 flex-1 min-h-0\">\n            {/* Chat panel - adjust width based on replay mode */}\n            <motion.div\n              layout\n              className={isReplayMode ? 'w-[50%] flex flex-col' : 'w-[50%] flex flex-col'}\n            >\n              <Shell className=\"h-full rounded-xl bg-white/95 dark:bg-gray-800/95 backdrop-blur-sm border border-[#E5E6EC] dark:border-none bg-[#FFFFFFE5] dark:shadow-gray-950/5\">\n                <ChatPanel />\n              </Shell>\n            </motion.div>\n\n            {/* Workspace panel */}\n            <motion.div layout className=\"w-[50%] flex flex-col\">\n              <Shell className=\"h-full rounded-xl bg-white/95 dark:bg-gray-800/95 backdrop-blur-sm border border-[#E5E6EC] dark:border-none bg-[#FFFFFFE5] dark:shadow-gray-950/5\">\n                <WorkspacePanel />\n              </Shell>\n            </motion.div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;ACvBA;AACA;AACA;AACA;AACA;AACA;AAUA;;;;;;;;;;AAUA;AACA;;AAOA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;;;;;;AACA;AAEA;AACA;AAIA;AAEA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;;AAEA;AAEA;AAEA;AACA;AAAA;;;;;;;;;;AAMA;AAAA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAGA;AACA;AACA;AACA;AACA;;;;;;AAIA;AAAA;AACA;AAAA;AAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAMA;AAEA;AACA;;AAEA;AAEA;AAEA;AACA;AAAA;;;;;;;;;;AAMA;AACA;AACA;AAGA;AAAA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;;AAIA;AACA;AACA;AACA;AACA;;;;;;AAIA;AAAA;AACA;AAAA;AAAA;;;;;;;;;;;;AAtBA;;;;;;;;;;;;;;;;AA8BA;AAEA;AACA;AAEA;;AAEA;AACA;AACA;;;;;;AAGA;AACA;;;;;AAEA;AAAA;AAAA;;;;;;;;;;;;AAIA;AAhJA;;AAOA;;;AAPA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAMA;;;;;;;;;AASA;AACA;;AACA;AAEA;AACA;AAEA;AACA;AAEA;AACA;;AAEA;;;;;AAGA;AAAA;;AAEA;;;;;AAGA;AAAA;AAEA;AAAA;;AAEA;AACA;AACA;AAEA;AAAA;AACA;;;;;;;;;;;;;;;AAKA;AAAA;AAAA;AACA;AAAA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQA;AA5CA;;AACA;AAGA;;;AAJA"}